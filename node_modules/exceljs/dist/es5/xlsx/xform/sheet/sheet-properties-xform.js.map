{"version":3,"sources":["../../../../../lib/xlsx/xform/sheet/sheet-properties-xform.js"],"names":["utils","require","BaseXform","ColorXform","PageSetupPropertiesXform","OutlinePropertiesXform","SheetPropertiesXform","module","exports","map","tabColor","pageSetUpPr","outlinePr","inherits","tag","render","xmlStream","model","addRollback","openNode","inner","pageSetup","outlineProperties","closeNode","commit","rollback","parseOpen","node","parser","name","reset","parseText","text","parseClose","undefined"],"mappings":"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","file":"sheet-properties-xform.js","sourcesContent":["/**\r\n * Copyright (c) 2015 Guyon Roche\r\n * LICENCE: MIT - please refer to LICENCE file included with this module\r\n * or https://github.com/guyonroche/exceljs/blob/master/LICENSE\r\n */\r\n\r\n'use strict';\r\n\r\nvar utils = require('../../../utils/utils');\r\nvar BaseXform = require('../base-xform');\r\nvar ColorXform = require('../style/color-xform');\r\nvar PageSetupPropertiesXform = require('./page-setup-properties-xform');\r\nvar OutlinePropertiesXform = require('./outline-properties-xform');\r\n\r\nvar SheetPropertiesXform = module.exports = function() {\r\n  this.map = {\r\n    tabColor: new ColorXform('tabColor'),\r\n    pageSetUpPr: new PageSetupPropertiesXform(),\r\n    outlinePr: new OutlinePropertiesXform(),\r\n  };\r\n};\r\n\r\nutils.inherits(SheetPropertiesXform, BaseXform, {\r\n\r\n  get tag() { return 'sheetPr'; },\r\n\r\n  render: function(xmlStream, model) {\r\n    if (model) {\r\n      xmlStream.addRollback();\r\n      xmlStream.openNode('sheetPr');\r\n\r\n      var inner = false;\r\n      inner = this.map.tabColor.render(xmlStream, model.tabColor) || inner;\r\n      inner = this.map.pageSetUpPr.render(xmlStream, model.pageSetup) || inner;\r\n      inner = this.map.outlinePr.render(xmlStream, model.outlineProperties) || inner;\r\n\r\n      if (inner) {\r\n        xmlStream.closeNode();\r\n        xmlStream.commit();\r\n      } else {\r\n        xmlStream.rollback();\r\n      }\r\n    }\r\n  },\r\n\r\n  parseOpen: function(node) {\r\n    if (this.parser) {\r\n      this.parser.parseOpen(node);\r\n      return true;\r\n    }\r\n    if (node.name === this.tag) {\r\n      this.reset();\r\n      return true;\r\n    }\r\n    if (this.map[node.name]) {\r\n      this.parser = this.map[node.name];\r\n      this.parser.parseOpen(node);\r\n      return true;\r\n    }\r\n    return false;\r\n  },\r\n  parseText: function(text) {\r\n    if (this.parser) {\r\n      this.parser.parseText(text);\r\n      return true;\r\n    }\r\n    return false;\r\n  },\r\n  parseClose: function(name) {\r\n    if (this.parser) {\r\n      if (!this.parser.parseClose(name)) {\r\n        this.parser = undefined;\r\n      }\r\n      return true;\r\n    }\r\n    if (this.map.tabColor.model || this.map.pageSetUpPr.model || this.map.outlinePr.model) {\r\n      this.model = {};\r\n      if (this.map.tabColor.model) {\r\n        this.model.tabColor = this.map.tabColor.model;\r\n      }\r\n      if (this.map.pageSetUpPr.model) {\r\n        this.model.pageSetup = this.map.pageSetUpPr.model;\r\n      }\r\n      if (this.map.outlinePr.model) {\r\n        this.model.outlineProperties = this.map.outlinePr.model;\r\n      }\r\n    } else {\r\n      this.model = null;\r\n    }\r\n    return false;\r\n  }\r\n});\r\n"]}